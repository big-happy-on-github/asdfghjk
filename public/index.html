<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>the states of lim</title>
    <link rel="stylesheet" href="/css/styles.css" />
</head>

<body onload="setup()">
    <div class="container">
        <h1>the states of lim</h1>
        <p id="subheading"></p>
        <p>
            To add Netlify Functions, create a JavaScript, TypeScript, or Go function to your project in a <code>netlify/functions</code> directory. You can customize the address for your functions using Netlify's Redirects API
        </p>
        <h2>Examples</h2>
        <ul>
            <li><a href="/.netlify/functions/hello?name=you">Hello World</a> ( /.netlify/functions/hello?name=you )</li>
            <li><a href="/api/hello?name=you">Hello World</a> ( /api/hello?name=you )</li>
        </ul>


        <h2>More information</h2>
        <ul>
            <li><a href="https://www.netlify.com/products/functions/?utm_campaign=dx-examples&utm_source=example-site&utm_medium=web&utm_content=example-hello-functions">About Netlify Functions</a></li>
            <li><a href="https://docs.netlify.com/functions/overview/?utm_campaign=dx-examples&utm_source=example-site&utm_medium=web&utm_content=example-hello-functions">Docs: Netlify Functions</a></li>
            <li><a href="https://docs.netlify.com/functions/logs/?utm_campaign=dx-examples&utm_source=example-site&utm_medium=web&utm_content=example-hello-functions">Accessing your function logs</a></li>
            <li><a href="https://functions.netlify.com/?utm_campaign=dx-examples&utm_source=example-site&utm_medium=web&utm_content=example-hello-functions">Learn serverless in the functions playground</a></li>
        </ul>

        <h2>Deploy your own</h2>
        <p>
            A great place to start is to clone and deploy your own copy of this example. You can do that by clicking the button below.
        </p>
        <p>
            Try it! ðŸ‘‰
            <a href="https://app.netlify.com/start/deploy?repository=https://github.com/netlify/example-hello-world-functions&utm_campaign=dx-examples"><img src="https://www.netlify.com/img/deploy/button.svg" class="dtn" alt="Deploy to Netlify"></a>
        </p>

        <p><small>Clicking the button will clone <a href="https://github.com/netlify/example-hello-world-functions">this repo</a> and deploy it as a new site on <a href="https://netlify.com/?utm_campaign=dx-examples">Netlify</a></small></p>
    </div>

    <script>
        const id;
        
        function generateRandomCode(length) {
            const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()-_=+[]{}|;:,.<>?';
            let randomCode = '';
            const charactersLength = characters.length;
            
            for (let i = 0; i < length; i++) {
            randomCode += characters.charAt(Math.floor(Math.random() * charactersLength));
            }
            
            return randomCode;
        }
        
        async function fetchData(httpMethod, id, data=false) {
            if (httpMethod == "GET") {
                const options = {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                };
            } else if (httpMethod == "POST") {
                const options = {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                };
            }
        
            const response = await fetch(`/.netlify/functions/save?id=${id}`, options);
            const data = await response.json();
            return data;
        }

        function setup() {
            if (!localStorage.getItem("id")) {
                id = generateRandomCode(8);
                localStorage.setItem("id", id);
            }

            document.getElementById("subheading").textContent = `user ${id}, lvl ${fetchData("GET", id).lvl}`;
        }
    </script>

</body>

</html>
